var E=Object.defineProperty;var F=(e,t,i)=>t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;var s=(e,t,i)=>F(e,typeof t!="symbol"?t+"":t,i);import"./modulepreload-polyfill-B5Qt9EMX.js";import{C as b,G as k,T as P,a as I,A as S}from"./HTMLText-BdaxDQUN.js";class y{constructor(t,i,a,r){s(this,"container");s(this,"emoji");s(this,"id");s(this,"isFlipped",!1);s(this,"isMatched",!1);s(this,"background");s(this,"emojiText");s(this,"width");s(this,"height");s(this,"isAnimating",!1);this.width=t,this.height=i,this.emoji=a,this.id=r,this.container=new b,this.container.eventMode="static",this.container.cursor="pointer",this.container.pivot.set(t/2,i/2),this.createCard(),this.setupInteraction()}createCard(){this.background=new k,this.background.beginFill(3447003),this.background.lineStyle(3,2719929),this.background.drawRoundedRect(0,0,this.width,this.height,10),this.background.endFill(),this.background.beginFill(6139362),this.background.drawRoundedRect(3,3,this.width-6,this.height-6,8),this.background.endFill(),this.container.addChild(this.background);const t=new P({fontFamily:"Arial",fontSize:36,fill:2899536,align:"center"});this.emojiText=new I(this.emoji,t),this.emojiText.anchor.set(.5),this.emojiText.position.set(this.width/2,this.height/2),this.emojiText.alpha=0,this.container.addChild(this.emojiText)}setupInteraction(){this.container.on("pointerdown",()=>{!this.isAnimating&&!this.isMatched&&window.onCardClick(this)}),this.container.on("pointerover",()=>{!this.isFlipped&&!this.isMatched&&!this.isAnimating&&this.container.scale.set(1.05)}),this.container.on("pointerout",()=>{!this.isFlipped&&!this.isMatched&&!this.isAnimating&&this.container.scale.set(1)})}setPosition(t,i){this.container.position.set(t+this.width/2,i+this.height/2)}flip(){this.isAnimating||(this.isAnimating=!0,this.isFlipped=!this.isFlipped,this.isFlipped?this.showEmoji():this.hideEmoji())}showEmoji(){this.container.scale.x=0,this.emojiText.alpha=1,this.background.clear(),this.background.beginFill(16777215),this.background.lineStyle(3,14737632),this.background.drawRoundedRect(0,0,this.width,this.height,10),this.background.endFill();const t=()=>{this.container.scale.x+=.2,this.container.scale.x>=1?(this.container.scale.set(1,1),this.isAnimating=!1):requestAnimationFrame(t)};t()}hideEmoji(){this.container.scale.x=0,this.emojiText.alpha=0,this.background.clear(),this.background.beginFill(3447003),this.background.lineStyle(3,2719929),this.background.drawRoundedRect(0,0,this.width,this.height,10),this.background.endFill(),this.background.beginFill(6139362),this.background.drawRoundedRect(3,3,this.width-6,this.height-6,8),this.background.endFill();const t=()=>{this.container.scale.x+=.2,this.container.scale.x>=1?(this.container.scale.set(1,1),this.isAnimating=!1):requestAnimationFrame(t)};t()}setMatched(){this.isMatched=!0,this.isFlipped=!0;const t=()=>{this.container.alpha-=.05,this.container.alpha>0?requestAnimationFrame(t):this.container.alpha=0};t()}reset(){this.isFlipped=!1,this.isMatched=!1,this.isAnimating=!1,this.container.alpha=1,this.container.scale.set(1),this.emojiText.alpha=0,this.background.clear(),this.background.beginFill(3447003),this.background.lineStyle(3,2719929),this.background.drawRoundedRect(0,0,this.width,this.height,10),this.background.endFill(),this.background.beginFill(6139362),this.background.drawRoundedRect(3,3,this.width-6,this.height-6,8),this.background.endFill()}}const o=800,d=600,u=4,m=6,v=.8,f=10,x=()=>{const t=o-40,i=d-20*2,a=(t-(m-1)*f)/m,c=(i-(u-1)*f)/u*v,g=Math.min(a,c),p=g/v;return{cardWidth:Math.floor(g),cardHeight:Math.floor(p),cardPadding:f}},n=x(),C=()=>{const e=window.innerWidth,t=window.innerHeight-120,i=e/o,a=t/d,r=Math.min(i,a);return{gameWidth:o,gameHeight:d,scale:r}},H=["🐶","🐱","🐭","🐹","🐰","🦊","🐻","🐼","🐨","🐯","🦁","🐮","🍎","🍌","🍇","🍓","🍊","🍒","🍑","🍍","🍐","🍋","🥕","🥬","🥦","🌽","🥔","🍅","😂","🤠","🤡","🏀","🏈","⚽","🎾","🏓","🎵","🎤","🎹","🎺","🎻","🔥","⚡","💡"],A=u*m/2;function R(){return[...H].sort(()=>Math.random()-.5).slice(0,A)}const w=R();class W{constructor(t){s(this,"app");s(this,"gameContainer");s(this,"cards",[]);s(this,"flippedCards",[]);s(this,"matchedPairs",0);s(this,"moves",0);s(this,"startTime",0);s(this,"gameTime",0);s(this,"isGameOver",!1);s(this,"isPaused",!1);s(this,"canFlip",!0);s(this,"removeInputHandler");s(this,"gameStarted",!1);s(this,"flipTimeout");this.app=t,this.gameContainer=new b,this.app.stage.addChild(this.gameContainer)}async init(){this.createBackground(),this.createCards(),this.shuffleCards(),this.positionCards(),this.setupInput(),this.updateUI()}createBackground(){const t=new k;t.beginFill(3426654),t.drawRect(0,0,o,d),t.endFill(),this.gameContainer.addChild(t)}createCards(){for(let t=0;t<w.length;t++){const i=w[t],a=new y(n.cardWidth,n.cardHeight,i,t*2),r=new y(n.cardWidth,n.cardHeight,i,t*2+1);this.cards.push(a,r),this.gameContainer.addChild(a.container),this.gameContainer.addChild(r.container)}}shuffleCards(){for(let t=this.cards.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[this.cards[t],this.cards[i]]=[this.cards[i],this.cards[t]]}}positionCards(){const{gameWidth:t,gameHeight:i}=C(),a=(t-(m*(n.cardWidth+n.cardPadding)-n.cardPadding))/2,r=(i-(u*(n.cardHeight+n.cardPadding)-n.cardPadding))/2;for(let c=0;c<this.cards.length;c++){const g=Math.floor(c/m),p=c%m,T=a+p*(n.cardWidth+n.cardPadding),M=r+g*(n.cardHeight+n.cardPadding);this.cards[c].setPosition(T,M)}}setupInput(){const t=i=>{if(!this.isGameOver)switch(i.key){case"Escape":i.preventDefault(),this.togglePause();break}};document.addEventListener("keydown",t),this.removeInputHandler=()=>{document.removeEventListener("keydown",t)}}update(t){this.isPaused||this.gameStarted&&!this.isGameOver&&(this.gameTime=Math.floor((Date.now()-this.startTime)/1e3),this.updateUI())}onCardClick(t){if(!(this.isPaused||this.isGameOver)&&!(t.isFlipped||t.isMatched)){if(this.gameStarted||(this.gameStarted=!0,this.startTime=Date.now()),this.flippedCards.length===2){this.flipTimeout&&(clearTimeout(this.flipTimeout),this.flipTimeout=void 0),this.flippedCards[0].flip(),this.flippedCards[1].flip(),this.flippedCards=[],this.canFlip=!0;return}t.flip(),this.flippedCards.push(t),this.flippedCards.length===2&&(this.moves++,this.canFlip=!1,this.flippedCards[0].emoji===this.flippedCards[1].emoji?(this.flippedCards[0].setMatched(),this.flippedCards[1].setMatched(),this.matchedPairs++,this.matchedPairs===w.length&&this.gameOver(),this.flippedCards=[],this.canFlip=!0):this.flipTimeout=setTimeout(()=>{this.flippedCards[0].flip(),this.flippedCards[1].flip(),this.flippedCards=[],this.canFlip=!0,this.flipTimeout=void 0},1e3),this.updateUI())}}gameOver(){this.isGameOver=!0,this.showGameOver()}showGameOver(){const t=document.getElementById("gameOver"),i=document.getElementById("finalMoves"),a=document.getElementById("finalTime");t&&i&&a&&(i.textContent=this.moves.toString(),a.textContent=this.formatTime(this.gameTime),t.style.display="block")}togglePause(){this.isPaused=!this.isPaused,this.isPaused?this.showPauseMenu():this.hidePauseMenu()}showPauseMenu(){const t=document.getElementById("pauseMenu");t&&(t.style.display="block")}hidePauseMenu(){const t=document.getElementById("pauseMenu");t&&(t.style.display="none")}updateUI(){const t=document.getElementById("moves"),i=document.getElementById("pairs"),a=document.getElementById("time");t&&(t.textContent=this.moves.toString()),i&&(i.textContent=this.matchedPairs.toString()),a&&(a.textContent=this.formatTime(this.gameTime))}formatTime(t){const i=Math.floor(t/60),a=t%60;return`${i.toString().padStart(2,"0")}:${a.toString().padStart(2,"0")}`}restart(){this.matchedPairs=0,this.moves=0,this.gameTime=0,this.isGameOver=!1,this.isPaused=!1,this.canFlip=!0,this.gameStarted=!1,this.flippedCards=[],this.flipTimeout&&(clearTimeout(this.flipTimeout),this.flipTimeout=void 0),this.cards.forEach(i=>{i.reset()}),this.shuffleCards(),this.positionCards(),this.startTime=0,this.updateUI();const t=document.getElementById("gameOver");t&&(t.style.display="none"),this.hidePauseMenu()}resume(){this.isPaused=!1,this.hidePauseMenu()}destroy(){this.removeInputHandler&&this.removeInputHandler(),this.flipTimeout&&clearTimeout(this.flipTimeout),this.gameContainer&&this.gameContainer.parent&&this.gameContainer.parent.removeChild(this.gameContainer)}}let h=null,l=null;function j(){if(!l)return;const e=C(),t=l.view;t.style.width=`${o*e.scale}px`,t.style.height=`${d*e.scale}px`,console.log("Memory canvas resized:",{scale:e.scale,scaledWidth:o*e.scale,scaledHeight:d*e.scale,styleWidth:t.style.width,styleHeight:t.style.height})}async function G(){const e=C();l=new S({width:o,height:d,backgroundColor:2899536,antialias:!0,resolution:window.devicePixelRatio||1});const t=document.getElementById("gameContainer");if(t){const i=l.view;i.style.width=`${o*e.scale}px`,i.style.height=`${d*e.scale}px`,i.style.maxWidth="100%",i.style.maxHeight="100%",i.style.objectFit="contain",t.appendChild(i),console.log("Memory dimensions:",{baseWidth:o,baseHeight:d,scale:e.scale,scaledWidth:o*e.scale,scaledHeight:d*e.scale,canvasWidth:i.width,canvasHeight:i.height,styleWidth:i.style.width,styleHeight:i.style.height})}h=new W(l),await h.init(),l.ticker.add(O),window.addEventListener("resize",j)}function O(e){h&&h.update(e)}window.restartGame=()=>{h&&h.restart()};window.returnToMainMenu=()=>{window.location.href="/arcade/"};window.resumeGame=()=>{h&&h.resume()};window.togglePause=()=>{h&&h.togglePause()};window.onCardClick=e=>{h&&h.onCardClick(e)};window.addEventListener("load",G);
//# sourceMappingURL=memory-BA_XHPI-.js.map
