var t=Object.defineProperty,e=(e,i,s)=>((e,i,s)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[i]=s)(e,"symbol"!=typeof i?i+"":i,s);import"./main-DwgLx9N3.js";import{C as i,G as s,T as h,a,A as n}from"./HTMLText-COKViVEb.js";import{i as r}from"./device-detection-DiiT1QW1.js";class o{constructor(t,s){e(this,"container"),e(this,"x",0),e(this,"y",0),e(this,"width"),e(this,"height"),e(this,"graphics"),this.width=t,this.height=s,this.container=new i,this.updateGraphics()}updateGraphics(){this.graphics&&this.container.removeChild(this.graphics),this.graphics=new s,this.graphics.beginFill(5164484),this.graphics.drawRoundedRect(0,0,this.width,this.height,5),this.graphics.endFill(),this.graphics.lineStyle(2,16777215,.8),this.graphics.drawRoundedRect(0,0,this.width,this.height,5),this.container.addChild(this.graphics)}setPosition(t,e){this.x=t,this.y=e,this.container.x=t,this.container.y=e}resize(t){this.width=t,this.updateGraphics()}getBounds(){return{left:this.x,right:this.x+this.width,top:this.y,bottom:this.y+this.height}}}var c=(t=>(t.NORMAL="normal",t.BLUE="blue",t))(c||{});class d{constructor(t,h="normal"){e(this,"container"),e(this,"x",0),e(this,"y",0),e(this,"radius"),e(this,"velocityX",0),e(this,"velocityY",0),e(this,"type"),e(this,"graphics"),this.radius=t,this.type=h,this.container=new i,this.graphics=new s;const a="blue"===this.type?3447003:16777215;this.graphics.beginFill(a),this.graphics.drawCircle(0,0,t),this.graphics.endFill();const n="blue"===this.type?2719929:2899536;this.graphics.lineStyle(2,n,.8),this.graphics.drawCircle(0,0,t),this.container.addChild(this.graphics)}setPosition(t,e){this.x=t,this.y=e,this.container.x=t,this.container.y=e}setVelocity(t,e){this.velocityX=t,this.velocityY=e}setVelocityAndAngle(t,e){this.velocityX=t*Math.sin(e),this.velocityY=-t*Math.cos(e)}setAngle(t){const e=Math.sqrt(this.velocityX*this.velocityX+this.velocityY*this.velocityY);this.velocityX=e*Math.sin(t),this.velocityY=-e*Math.cos(t)}reverseX(){this.velocityX=-this.velocityX}reverseY(){this.velocityY=-this.velocityY}update(){this.x+=this.velocityX,this.y+=this.velocityY,this.container.x=this.x,this.container.y=this.y}getBounds(){return{left:this.x-this.radius,right:this.x+this.radius,top:this.y-this.radius,bottom:this.y+this.radius}}checkCollisionWithPaddle(t){const e=this.getBounds(),i=t.getBounds();return e.left<i.right&&e.right>i.left&&e.top<i.bottom&&e.bottom>i.top}checkCollisionWithBrick(t){const e=this.getBounds(),i=t.getBounds();return e.left<i.right&&e.right>i.left&&e.top<i.bottom&&e.bottom>i.top}}class l{constructor(t,s,h){e(this,"container"),e(this,"x",0),e(this,"y",0),e(this,"width"),e(this,"height"),e(this,"maxHealth"),e(this,"health"),e(this,"graphics"),this.width=t,this.height=s,this.maxHealth=h,this.health=h,this.container=new i,this.updateGraphics()}updateGraphics(){this.graphics&&this.container.removeChild(this.graphics),this.graphics=new s;const t=[3066993,15844367,15105570,15158332,12597547][Math.max(0,this.health-1)];this.graphics.beginFill(t),this.graphics.drawRoundedRect(0,0,this.width,this.height,3),this.graphics.endFill(),this.graphics.lineStyle(1,16777215,.3),this.graphics.drawRoundedRect(0,0,this.width,this.height,3),this.graphics.lineStyle(1,16777215,.6),this.graphics.drawRoundedRect(2,2,this.width-4,this.height-4,2),this.container.addChild(this.graphics)}setPosition(t,e){this.x=t,this.y=e,this.container.x=t,this.container.y=e}hit(){return this.health--,this.updateGraphics(),this.health<=0}getBounds(){return{left:this.x,right:this.x+this.width,top:this.y,bottom:this.y+this.height}}getColor(){return[3066993,15844367,15105570,15158332,12597547][Math.max(0,this.health-1)]}}var p=(t=>(t.PADDLE_INCREASE="paddle_increase",t.PADDLE_DECREASE="paddle_decrease",t.EXTRA_LIFE="extra_life",t.BLUE_BALL="blue_ball",t))(p||{});class u{constructor(t,s,h){e(this,"container"),e(this,"x",0),e(this,"y",0),e(this,"type"),e(this,"width",30),e(this,"height",30),e(this,"velocityY",2),e(this,"graphics"),e(this,"text"),this.type=t,this.x=s,this.y=h,this.container=new i,this.createGraphics(),this.setPosition(s,h)}createGraphics(){let t,e;switch(this.graphics=new s,this.type){case"paddle_increase":t=3066993,e="+";break;case"paddle_decrease":t=15158332,e="-";break;case"extra_life":t=15965202,e="♥";break;case"blue_ball":t=3447003,e="●"}this.graphics.beginFill(t),this.graphics.drawRoundedRect(0,0,this.width,this.height,5),this.graphics.endFill(),this.graphics.lineStyle(2,16777215,.8),this.graphics.drawRoundedRect(0,0,this.width,this.height,5);const i=new h({fontFamily:"Arial",fontSize:16,fontWeight:"bold",fill:16777215,stroke:0,strokeThickness:2});this.text=new a(e,i),this.text.anchor.set(.5),this.text.x=this.width/2,this.text.y=this.height/2,this.container.addChild(this.graphics),this.container.addChild(this.text)}setPosition(t,e){this.x=t,this.y=e,this.container.x=t,this.container.y=e}update(){this.y+=this.velocityY,this.container.y=this.y}getBounds(){return{left:this.x,right:this.x+this.width,top:this.y,bottom:this.y+this.height}}isOutOfBounds(t){return this.y>t}}class m{constructor(t,h,a){e(this,"container"),e(this,"graphics"),e(this,"velocityX"),e(this,"velocityY"),e(this,"life"),e(this,"maxLife"),e(this,"gravity",.3),e(this,"friction",.98),this.container=new i,this.container.position.set(t,h),this.graphics=new s,this.graphics.beginFill(a),this.graphics.drawCircle(0,0,3*Math.random()+1),this.graphics.endFill(),this.container.addChild(this.graphics),this.velocityX=8*(Math.random()-.5),this.velocityY=8*(Math.random()-.5)-2,this.maxLife=60*Math.random()+30,this.life=this.maxLife}update(){this.velocityY+=this.gravity,this.velocityX*=this.friction,this.velocityY*=this.friction,this.container.x+=this.velocityX,this.container.y+=this.velocityY,this.life--;const t=this.life/this.maxLife;this.graphics.alpha=t;const e=.5+.5*t;return this.graphics.scale.set(e),this.life>0}destroy(){this.container.parent&&this.container.parent.removeChild(this.container)}}class g{constructor(t){e(this,"particles",[]),e(this,"container"),this.container=t}createExplosion(t,e,i,s=8){for(let h=0;h<s;h++){const s=new m(t,e,i);this.particles.push(s),this.container.addChild(s.container)}}update(){for(let t=this.particles.length-1;t>=0;t--){const e=this.particles[t];e.update()||(e.destroy(),this.particles.splice(t,1))}}clear(){this.particles.forEach(t=>t.destroy()),this.particles=[]}}const v=900,y=500,w=100,f=r()?7*.7:7,C=()=>{const t=window.innerWidth,e=window.innerHeight-120,i=t/v,s=e/y,h=Math.min(i,s);return{gameWidth:v,gameHeight:y,scale:h}};class P{constructor(t){e(this,"app"),e(this,"gameContainer"),e(this,"paddle"),e(this,"balls",[]),e(this,"bricks",[]),e(this,"powerUps",[]),e(this,"particleSystem"),e(this,"score",0),e(this,"lives",3),e(this,"level",1),e(this,"isGameOver",!1),e(this,"isPaused",!1),e(this,"isGameStarted",!1),e(this,"removeInputHandler"),e(this,"removeTopBarHandler"),e(this,"currentPaddleWidth",w),e(this,"safetyNetActive",!1),e(this,"safetyNet"),e(this,"lastUpdateTime",0),e(this,"updateInterval",1e3/60),this.app=t,this.gameContainer=new i,this.app.stage.addChild(this.gameContainer),this.particleSystem=new g(this.gameContainer)}async init(){this.createBackground(),this.paddle=new o(w,20),this.gameContainer.addChild(this.paddle.container),this.paddle.setPosition(450-this.currentPaddleWidth/2,470),this.createBricks(),this.setupInput(),this.setupTopBarEvents(),this.updateUI(),this.resetObjects()}setupTopBarEvents(){const t=t=>{"pause"===t.type?this.togglePause():"menu"===t.type&&this.returnToMainMenu()};document.addEventListener("pause",t),document.addEventListener("menu",t),this.removeTopBarHandler=()=>{document.removeEventListener("pause",t),document.removeEventListener("menu",t)}}createBackground(){const t=new s;t.beginFill(3426654),t.drawRect(0,0,v,y),t.endFill(),this.gameContainer.addChild(t),this.safetyNet=new s,this.safetyNet.beginFill(3066993,.7),this.safetyNet.drawRect(0,495,v,5),this.safetyNet.endFill(),this.safetyNet.visible=!1,this.gameContainer.addChild(this.safetyNet)}createBricks(){const t=[4,3,2,1,1];for(let e=0;e<5;e++)for(let i=0;i<10;i++){const s=89.9*i+1,h=50+31*e,a=new l(88.9,30,t[e]);a.setPosition(s,h),this.bricks.push(a),this.gameContainer.addChild(a.container)}}setupInput(){const t=t=>{if(!this.isGameOver)switch(t.key){case" ":case"Enter":t.preventDefault(),this.isGameStarted||this.startGame();break;case"Escape":t.preventDefault(),this.togglePause()}},e=t=>{if(this.isGameOver||this.isPaused)return;const e=t,i=this.app.view.getBoundingClientRect(),s=(e.clientX-i.left)/i.width*v-this.currentPaddleWidth/2,h=Math.max(0,Math.min(v-this.currentPaddleWidth,s));this.paddle.setPosition(h,470)},i=t=>{this.isGameOver||this.isPaused||this.isGameStarted||this.startGame()};let s=!1,h=!1,a=0,n=0;const r=t=>{if(this.isGameOver||this.isPaused)return;const e=t.touches[0];if(e.clientY<80)return;s=!0,h=!1,a=e.clientX,n=e.clientY,t.preventDefault();const i=e.clientX,r=this.app.view.getBoundingClientRect(),o=(i-r.left)/(r.width/v)-this.currentPaddleWidth/2,c=Math.max(0,Math.min(v-this.currentPaddleWidth,o));this.paddle.setPosition(c,470),this.isGameStarted||this.startGame()},o=t=>{if(!s||this.isGameOver||this.isPaused)return;const e=t.touches[0];if(e.clientY<80)return;t.preventDefault();const i=Math.abs(e.clientX-a),r=Math.abs(e.clientY-n),o=Math.sqrt(i*i+r*r);if(!h&&o>10&&(h=!0),h){const t=e.clientX,i=this.app.view.getBoundingClientRect(),s=(t-i.left)/(i.width/v)-this.currentPaddleWidth/2,h=Math.max(0,Math.min(v-this.currentPaddleWidth,s)),a=470;this.paddle.setPosition(h,a)}},c=t=>{s=!1,h=!1};document.addEventListener("keydown",t);const d=this.app.view;d.addEventListener("mousemove",e),d.addEventListener("click",i),document.addEventListener("touchstart",r,{passive:!1}),document.addEventListener("touchmove",o,{passive:!1}),document.addEventListener("touchend",c,{passive:!1}),this.removeInputHandler=()=>{document.removeEventListener("keydown",t),d.removeEventListener("mousemove",e),d.removeEventListener("click",i),document.removeEventListener("touchstart",r),document.removeEventListener("touchmove",o),document.removeEventListener("touchend",c)}}startGame(){this.isGameStarted=!0,this.balls.forEach(t=>t.setVelocity(0,-f))}resetObjects(){this.balls.forEach(t=>{this.gameContainer.removeChild(t.container)}),this.balls=[];const t=new d(10,c.NORMAL);this.balls.push(t),this.gameContainer.addChild(t.container),this.isGameStarted=!1,this.currentPaddleWidth=w,this.paddle.resize(this.currentPaddleWidth),this.paddle.setPosition(450-this.currentPaddleWidth/2,470)}update(t){if(this.isGameOver||this.isPaused)return;const e=performance.now();e-this.lastUpdateTime<this.updateInterval||(this.lastUpdateTime=e,this.isGameStarted?(this.balls.forEach(t=>t.update()),this.checkCollisions()):this.balls.forEach(t=>t.setPosition(this.paddle.x+this.currentPaddleWidth/2,450)),this.updatePowerUps(),this.particleSystem.update())}checkCollisions(){for(let t=this.balls.length-1;t>=0;t--){const e=this.balls[t],i=e.getBounds();if(i.left<=0?(e.setPosition(e.radius,e.y),e.reverseX()):i.right>=v&&(e.setPosition(v-e.radius,e.y),e.reverseX()),i.top<=0&&(e.setPosition(e.x,e.radius),e.reverseY()),i.top>=y)e.type===c.BLUE?(this.gameContainer.removeChild(e.container),this.balls.splice(t,1)):this.safetyNetActive?(e.setPosition(e.x,y-e.radius-5),e.reverseY(),this.safetyNetActive=!1,this.safetyNet.visible=!1):(this.gameContainer.removeChild(e.container),this.balls.splice(t,1),this.loseLife());else{if(e.checkCollisionWithPaddle(this.paddle)&&e.y>this.paddle.y){e.setPosition(e.x,this.paddle.y-e.radius),e.reverseY();const t=(e.x-this.paddle.x)/this.currentPaddleWidth,i=.5,s=Math.abs(t-i),h=f*(1+s),a=.8*(t-i);e.setVelocityAndAngle(h,a)}for(let t=this.bricks.length-1;t>=0;t--){const i=this.bricks[t];if(e.checkCollisionWithBrick(i)){const s=e.getBounds(),h=i.getBounds();if(Math.min(s.right-h.left,h.right-s.left)<Math.min(s.bottom-h.top,h.bottom-s.top)?e.reverseX():e.reverseY(),i.hit()){const e=i.getColor();this.particleSystem.createExplosion(i.x+44.45,i.y+15,e,12),this.bricks.splice(t,1),this.gameContainer.removeChild(i.container),Math.random()<.25&&this.spawnPowerUp(i.x+44.45,i.y+30)}this.score+=10,this.updateUI(),0===this.bricks.length&&this.nextLevel();break}}}}}loseLife(){this.lives--,this.updateUI(),this.resetObjects(),this.lives<=0&&this.gameOver()}nextLevel(){this.level++,this.updateUI(),this.createBricks(),this.resetObjects()}gameOver(){this.isGameOver=!0,this.showGameOver()}showGameOver(){const t=document.getElementById("gameOver"),e=document.getElementById("finalScore");t&&e&&(e.textContent=this.score.toString(),t.style.display="block")}togglePause(){this.isPaused=!this.isPaused,this.isPaused?this.showPauseMenu():this.hidePauseMenu()}showPauseMenu(){const t=document.getElementById("pauseMenu");t&&(t.style.display="block")}hidePauseMenu(){const t=document.getElementById("pauseMenu");t&&(t.style.display="none")}updateUI(){const t=document.getElementById("score"),e=document.getElementById("lives"),i=document.getElementById("level");t&&(t.textContent=this.score.toString()),e&&(e.textContent=this.lives.toString()),i&&(i.textContent=this.level.toString())}restart(){this.score=0,this.lives=3,this.level=1,this.isGameOver=!1,this.isPaused=!1,this.isGameStarted=!1,this.currentPaddleWidth=w,this.safetyNetActive=!1,this.safetyNet.visible=!1,this.particleSystem.clear(),this.balls.forEach(t=>{this.gameContainer.removeChild(t.container)}),this.balls=[],this.bricks.forEach(t=>{this.gameContainer.removeChild(t.container)}),this.bricks=[],this.powerUps.forEach(t=>{this.gameContainer.removeChild(t.container)}),this.powerUps=[],this.createBricks(),this.resetObjects(),this.updateUI();const t=document.getElementById("gameOver");t&&(t.style.display="none"),this.hidePauseMenu()}resume(){this.isPaused=!1,this.hidePauseMenu()}destroy(){this.removeInputHandler&&this.removeInputHandler(),this.removeTopBarHandler&&this.removeTopBarHandler(),this.particleSystem.clear(),this.balls.forEach(t=>{t.container.parent&&t.container.parent.removeChild(t.container)}),this.balls=[],this.gameContainer&&this.gameContainer.parent&&this.gameContainer.parent.removeChild(this.gameContainer)}spawnPowerUp(t,e){const i=[p.PADDLE_INCREASE,p.PADDLE_DECREASE,p.EXTRA_LIFE,p.BLUE_BALL],s=i[Math.floor(Math.random()*i.length)],h=new u(s,t,e);this.powerUps.push(h),this.gameContainer.addChild(h.container)}updatePowerUps(){for(let t=this.powerUps.length-1;t>=0;t--){const e=this.powerUps[t];e.update(),e.isOutOfBounds(y)?(this.powerUps.splice(t,1),this.gameContainer.removeChild(e.container)):this.checkPowerUpCollision(e)&&(this.applyPowerUp(e.type),this.powerUps.splice(t,1),this.gameContainer.removeChild(e.container))}}checkPowerUpCollision(t){const e=t.getBounds(),i=this.paddle.getBounds();return e.left<i.right&&e.right>i.left&&e.top<i.bottom&&e.bottom>i.top}applyPowerUp(t){switch(t){case p.PADDLE_INCREASE:this.currentPaddleWidth=Math.min(1.3*this.currentPaddleWidth,200),this.paddle.resize(this.currentPaddleWidth);break;case p.PADDLE_DECREASE:this.currentPaddleWidth=Math.max(.8*this.currentPaddleWidth,50),this.paddle.resize(this.currentPaddleWidth);break;case p.EXTRA_LIFE:this.safetyNetActive||(this.safetyNetActive=!0,this.safetyNet.visible=!0);break;case p.BLUE_BALL:const t=new d(10,c.BLUE);t.setPosition(this.paddle.x+this.currentPaddleWidth/2,450),t.setVelocity(0,-f),this.balls.push(t),this.gameContainer.addChild(t.container)}}movePaddle(t){if(this.isGameOver||this.isPaused)return;const e=Math.max(0,Math.min(v-this.currentPaddleWidth,this.paddle.x+t));this.paddle.setPosition(e,470)}returnToMainMenu(){window.location.href="/arcade/"}}let b=null,E=null;function x(){if(!E)return;const t=C(),e=E.view;e.style.width=v*t.scale+"px",e.style.height=y*t.scale+"px"}function B(t){b&&b.update(t)}window.restartGame=()=>{b&&b.restart()},window.returnToMainMenu=()=>{b&&b.returnToMainMenu()},window.resumeGame=()=>{b&&b.resume()},window.togglePause=()=>{b&&b.togglePause()},window.addEventListener("load",async function(){const t=C();E=new n({width:v,height:y,backgroundColor:2899536,antialias:!0,resolution:window.devicePixelRatio||1});const e=document.getElementById("gameContainer");if(e){const i=E.view;i.style.width=v*t.scale+"px",i.style.height=y*t.scale+"px",i.style.maxWidth="100%",i.style.maxHeight="100%",i.style.objectFit="contain",e.appendChild(i)}b=new P(E),await b.init(),E.ticker.add(B),window.addEventListener("resize",x)});
