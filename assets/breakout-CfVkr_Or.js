var R=Object.defineProperty;var X=(h,t,e)=>t in h?R(h,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):h[t]=e;var s=(h,t,e)=>X(h,typeof t!="symbol"?t+"":t,e);import"./modulepreload-polyfill-B5Qt9EMX.js";import{C as b,G as m,T as _,a as Y,A as U}from"./HTMLText-Dcivl2sH.js";class O{constructor(t,e){s(this,"container");s(this,"x",0);s(this,"y",0);s(this,"width");s(this,"height");s(this,"graphics");this.width=t,this.height=e,this.container=new b,this.updateGraphics()}updateGraphics(){this.graphics&&this.container.removeChild(this.graphics),this.graphics=new m,this.graphics.beginFill(5164484),this.graphics.drawRoundedRect(0,0,this.width,this.height,5),this.graphics.endFill(),this.graphics.lineStyle(2,16777215,.8),this.graphics.drawRoundedRect(0,0,this.width,this.height,5),this.container.addChild(this.graphics)}setPosition(t,e){this.x=t,this.y=e,this.container.x=t,this.container.y=e}resize(t){this.width=t,this.updateGraphics()}getBounds(){return{left:this.x,right:this.x+this.width,top:this.y,bottom:this.y+this.height}}}class H{constructor(t){s(this,"container");s(this,"x",0);s(this,"y",0);s(this,"radius");s(this,"velocityX",0);s(this,"velocityY",0);s(this,"graphics");this.radius=t,this.container=new b,this.graphics=new m,this.graphics.beginFill(16777215),this.graphics.drawCircle(0,0,t),this.graphics.endFill(),this.graphics.lineStyle(2,2899536,.8),this.graphics.drawCircle(0,0,t),this.container.addChild(this.graphics)}setPosition(t,e){this.x=t,this.y=e,this.container.x=t,this.container.y=e}setVelocity(t,e){this.velocityX=t,this.velocityY=e}setVelocityAndAngle(t,e){this.velocityX=t*Math.sin(e),this.velocityY=-t*Math.cos(e)}setAngle(t){const e=Math.sqrt(this.velocityX*this.velocityX+this.velocityY*this.velocityY);this.velocityX=e*Math.sin(t),this.velocityY=-e*Math.cos(t)}reverseX(){this.velocityX=-this.velocityX}reverseY(){this.velocityY=-this.velocityY}update(){this.x+=this.velocityX,this.y+=this.velocityY,this.container.x=this.x,this.container.y=this.y}getBounds(){return{left:this.x-this.radius,right:this.x+this.radius,top:this.y-this.radius,bottom:this.y+this.radius}}checkCollisionWithPaddle(t){const e=this.getBounds(),i=t.getBounds();return e.left<i.right&&e.right>i.left&&e.top<i.bottom&&e.bottom>i.top}checkCollisionWithBrick(t){const e=this.getBounds(),i=t.getBounds();return e.left<i.right&&e.right>i.left&&e.top<i.bottom&&e.bottom>i.top}}class N{constructor(t,e,i){s(this,"container");s(this,"x",0);s(this,"y",0);s(this,"width");s(this,"height");s(this,"maxHealth");s(this,"health");s(this,"graphics");this.width=t,this.height=e,this.maxHealth=i,this.health=i,this.container=new b,this.updateGraphics()}updateGraphics(){this.graphics&&this.container.removeChild(this.graphics),this.graphics=new m;const t=[3066993,15844367,15105570,15158332,12597547],e=Math.max(0,this.health-1),i=t[e];this.graphics.beginFill(i),this.graphics.drawRoundedRect(0,0,this.width,this.height,3),this.graphics.endFill(),this.graphics.lineStyle(1,16777215,.3),this.graphics.drawRoundedRect(0,0,this.width,this.height,3),this.graphics.lineStyle(1,16777215,.6),this.graphics.drawRoundedRect(2,2,this.width-4,this.height-4,2),this.container.addChild(this.graphics)}setPosition(t,e){this.x=t,this.y=e,this.container.x=t,this.container.y=e}hit(){return this.health--,this.updateGraphics(),this.health<=0}getBounds(){return{left:this.x,right:this.x+this.width,top:this.y,bottom:this.y+this.height}}getColor(){const t=[3066993,15844367,15105570,15158332,12597547],e=Math.max(0,this.health-1);return t[e]}}var g=(h=>(h.PADDLE_INCREASE="paddle_increase",h.PADDLE_DECREASE="paddle_decrease",h.EXTRA_LIFE="extra_life",h))(g||{});class F{constructor(t,e,i){s(this,"container");s(this,"x",0);s(this,"y",0);s(this,"type");s(this,"width",30);s(this,"height",30);s(this,"velocityY",2);s(this,"graphics");s(this,"text");this.type=t,this.x=e,this.y=i,this.container=new b,this.createGraphics(),this.setPosition(e,i)}createGraphics(){this.graphics=new m;let t,e;switch(this.type){case"paddle_increase":t=3066993,e="+";break;case"paddle_decrease":t=15158332,e="-";break;case"extra_life":t=15965202,e="â™¥";break}this.graphics.beginFill(t),this.graphics.drawRoundedRect(0,0,this.width,this.height,5),this.graphics.endFill(),this.graphics.lineStyle(2,16777215,.8),this.graphics.drawRoundedRect(0,0,this.width,this.height,5);const i=new _({fontFamily:"Arial",fontSize:16,fontWeight:"bold",fill:16777215,stroke:0,strokeThickness:2});this.text=new Y(e,i),this.text.anchor.set(.5),this.text.x=this.width/2,this.text.y=this.height/2,this.container.addChild(this.graphics),this.container.addChild(this.text)}setPosition(t,e){this.x=t,this.y=e,this.container.x=t,this.container.y=e}update(){this.y+=this.velocityY,this.container.y=this.y}getBounds(){return{left:this.x,right:this.x+this.width,top:this.y,bottom:this.y+this.height}}isOutOfBounds(t){return this.y>t}}class T{constructor(t,e,i){s(this,"container");s(this,"graphics");s(this,"velocityX");s(this,"velocityY");s(this,"life");s(this,"maxLife");s(this,"gravity",.3);s(this,"friction",.98);this.container=new b,this.container.position.set(t,e),this.graphics=new m,this.graphics.beginFill(i),this.graphics.drawCircle(0,0,Math.random()*3+1),this.graphics.endFill(),this.container.addChild(this.graphics),this.velocityX=(Math.random()-.5)*8,this.velocityY=(Math.random()-.5)*8-2,this.maxLife=Math.random()*60+30,this.life=this.maxLife}update(){this.velocityY+=this.gravity,this.velocityX*=this.friction,this.velocityY*=this.friction,this.container.x+=this.velocityX,this.container.y+=this.velocityY,this.life--;const t=this.life/this.maxLife;this.graphics.alpha=t;const e=.5+t*.5;return this.graphics.scale.set(e),this.life>0}destroy(){this.container.parent&&this.container.parent.removeChild(this.container)}}class z{constructor(t){s(this,"particles",[]);s(this,"container");this.container=t}createExplosion(t,e,i,o=8){for(let r=0;r<o;r++){const c=new T(t,e,i);this.particles.push(c),this.container.addChild(c.container)}}update(){for(let t=this.particles.length-1;t>=0;t--){const e=this.particles[t];e.update()||(e.destroy(),this.particles.splice(t,1))}}clear(){this.particles.forEach(t=>t.destroy()),this.particles=[]}}const n=900,a=500,f=100,u=20,K=10,E=30,V=5,I=10,B=1,S=8,$=.1,x=(n-(I+1)*B)/I,L=()=>{const h=window.innerWidth,t=window.innerHeight-120,e=h/n,i=t/a,o=Math.min(e,i);return{gameWidth:n,gameHeight:a,scale:o}};class j{constructor(t){s(this,"app");s(this,"gameContainer");s(this,"paddle");s(this,"ball");s(this,"bricks",[]);s(this,"powerUps",[]);s(this,"particleSystem");s(this,"score",0);s(this,"lives",3);s(this,"level",1);s(this,"isGameOver",!1);s(this,"isPaused",!1);s(this,"isGameStarted",!1);s(this,"removeInputHandler");s(this,"currentPaddleWidth",f);s(this,"safetyNetActive",!1);s(this,"safetyNet");this.app=t,this.gameContainer=new b,this.app.stage.addChild(this.gameContainer),this.particleSystem=new z(this.gameContainer)}async init(){this.createBackground(),this.paddle=new O(f,u),this.gameContainer.addChild(this.paddle.container),this.ball=new H(K),this.gameContainer.addChild(this.ball.container),this.createBricks(),this.setupInput(),this.updateUI(),this.paddle.setPosition(n/2-this.currentPaddleWidth/2,a-u-10),this.resetBall()}createBackground(){const t=new m;t.beginFill(3426654),t.drawRect(0,0,n,a),t.endFill(),this.gameContainer.addChild(t),this.safetyNet=new m,this.safetyNet.beginFill(3066993,.7),this.safetyNet.drawRect(0,a-5,n,5),this.safetyNet.endFill(),this.safetyNet.visible=!1,this.gameContainer.addChild(this.safetyNet)}createBricks(){const t=[5,4,3,2,1],e=50;for(let i=0;i<V;i++)for(let o=0;o<I;o++){const r=o*(x+B)+B,c=e+i*(E+B),d=new N(x,E,t[i]);d.setPosition(r,c),this.bricks.push(d),this.gameContainer.addChild(d.container)}}setupInput(){const t=l=>{if(!this.isGameOver)switch(l.key){case" ":l.preventDefault(),this.isGameStarted?this.togglePause():this.startGame();break;case"Escape":l.preventDefault(),this.togglePause();break;case"ArrowLeft":case"a":case"A":if(l.preventDefault(),!this.isPaused){const y=Math.max(0,this.paddle.x-20),v=a-u-10;this.paddle.setPosition(y,v)}break;case"ArrowRight":case"d":case"D":if(l.preventDefault(),!this.isPaused){const y=Math.min(n-this.currentPaddleWidth,this.paddle.x+20),v=a-u-10;this.paddle.setPosition(y,v)}break}},e=l=>{if(this.isGameOver||this.isPaused)return;const y=l,C=this.app.view.getBoundingClientRect(),M=y.clientX-C.left,k=n/C.width,A=M*k-this.currentPaddleWidth/2,W=Math.max(0,Math.min(n-this.currentPaddleWidth,A)),D=a-u-10;this.paddle.setPosition(W,D)},i=l=>{this.isGameOver||this.isPaused||this.isGameStarted||this.startGame()};let o=!1;const r=l=>{this.isGameOver||this.isPaused||(o=!0,l.preventDefault(),this.isGameStarted||this.startGame())},c=l=>{if(!o||this.isGameOver||this.isPaused)return;l.preventDefault();const v=l.touches[0].clientX,C=window.innerWidth,k=v/C*n-this.currentPaddleWidth/2,G=Math.max(0,Math.min(n-this.currentPaddleWidth,k)),A=a-u-10;this.paddle.setPosition(G,A)},d=l=>{o=!1};document.addEventListener("keydown",t);const P=this.app.view;P.addEventListener("mousemove",e),P.addEventListener("click",i),document.addEventListener("touchstart",r,{passive:!1}),document.addEventListener("touchmove",c,{passive:!1}),document.addEventListener("touchend",d,{passive:!1}),this.removeInputHandler=()=>{document.removeEventListener("keydown",t),P.removeEventListener("mousemove",e),P.removeEventListener("click",i),document.removeEventListener("touchstart",r),document.removeEventListener("touchmove",c),document.removeEventListener("touchend",d)}}startGame(){this.isGameStarted=!0,this.ball.setVelocity(0,-S)}resetBall(){this.ball.setPosition(n/2,a-u-30),this.ball.setVelocity(0,0),this.isGameStarted=!1}update(t){this.isGameOver||this.isPaused||(this.isGameStarted?(this.ball.update(),this.checkCollisions()):this.ball.setPosition(this.paddle.x+this.currentPaddleWidth/2,a-u-30),this.updatePowerUps(),this.particleSystem.update())}checkCollisions(){const t=this.ball.getBounds();if(t.left<=0?(this.ball.setPosition(this.ball.radius,this.ball.y),this.ball.reverseX()):t.right>=n&&(this.ball.setPosition(n-this.ball.radius,this.ball.y),this.ball.reverseX()),t.top<=0&&(this.ball.setPosition(this.ball.x,this.ball.radius),this.ball.reverseY()),t.top>=a){this.safetyNetActive?(this.ball.setPosition(this.ball.x,a-this.ball.radius-5),this.ball.reverseY(),this.safetyNetActive=!1,this.safetyNet.visible=!1):this.loseLife();return}if(this.ball.checkCollisionWithPaddle(this.paddle)&&this.ball.y>this.paddle.y){this.ball.setPosition(this.ball.x,this.paddle.y-this.ball.radius),this.ball.reverseY();const e=(this.ball.x-this.paddle.x)/this.currentPaddleWidth,i=.5,r=1+Math.abs(e-i),c=S*r,d=(e-i)*.8;this.ball.setVelocityAndAngle(c,d)}for(let e=this.bricks.length-1;e>=0;e--){const i=this.bricks[e];if(this.ball.checkCollisionWithBrick(i)){const o=this.ball.getBounds(),r=i.getBounds(),c=Math.min(o.right-r.left,r.right-o.left),d=Math.min(o.bottom-r.top,r.bottom-o.top);if(c<d?this.ball.reverseX():this.ball.reverseY(),i.hit()){const l=i.getColor();this.particleSystem.createExplosion(i.x+x/2,i.y+E/2,l,12),this.bricks.splice(e,1),this.gameContainer.removeChild(i.container),Math.random()<$&&this.spawnPowerUp(i.x+x/2,i.y+E)}this.score+=10,this.updateUI(),this.bricks.length===0&&this.nextLevel();break}}}loseLife(){this.lives--,this.updateUI(),this.currentPaddleWidth=f,this.paddle.resize(this.currentPaddleWidth),this.lives<=0?this.gameOver():this.resetBall()}nextLevel(){this.level++,this.updateUI(),this.createBricks(),this.resetBall()}gameOver(){this.isGameOver=!0,this.showGameOver()}showGameOver(){const t=document.getElementById("gameOver"),e=document.getElementById("finalScore");t&&e&&(e.textContent=this.score.toString(),t.style.display="block")}togglePause(){this.isPaused=!this.isPaused,this.isPaused?this.showPauseMenu():this.hidePauseMenu()}showPauseMenu(){const t=document.getElementById("pauseMenu");t&&(t.style.display="block")}hidePauseMenu(){const t=document.getElementById("pauseMenu");t&&(t.style.display="none")}updateUI(){const t=document.getElementById("score"),e=document.getElementById("lives"),i=document.getElementById("level");t&&(t.textContent=this.score.toString()),e&&(e.textContent=this.lives.toString()),i&&(i.textContent=this.level.toString())}restart(){this.score=0,this.lives=3,this.level=1,this.isGameOver=!1,this.isPaused=!1,this.isGameStarted=!1,this.currentPaddleWidth=f,this.safetyNetActive=!1,this.safetyNet.visible=!1,this.particleSystem.clear(),this.bricks.forEach(e=>{this.gameContainer.removeChild(e.container)}),this.bricks=[],this.powerUps.forEach(e=>{this.gameContainer.removeChild(e.container)}),this.powerUps=[],this.createBricks(),this.resetBall(),this.paddle.setPosition(n/2-this.currentPaddleWidth/2,a-u-10),this.paddle.resize(this.currentPaddleWidth),this.updateUI();const t=document.getElementById("gameOver");t&&(t.style.display="none"),this.hidePauseMenu()}resume(){this.isPaused=!1,this.hidePauseMenu()}destroy(){this.removeInputHandler&&this.removeInputHandler(),this.particleSystem.clear(),this.gameContainer&&this.gameContainer.parent&&this.gameContainer.parent.removeChild(this.gameContainer)}spawnPowerUp(t,e){const i=[g.PADDLE_INCREASE,g.PADDLE_DECREASE,g.EXTRA_LIFE],o=i[Math.floor(Math.random()*i.length)],r=new F(o,t,e);this.powerUps.push(r),this.gameContainer.addChild(r.container)}updatePowerUps(){for(let t=this.powerUps.length-1;t>=0;t--){const e=this.powerUps[t];if(e.update(),e.isOutOfBounds(a)){this.powerUps.splice(t,1),this.gameContainer.removeChild(e.container);continue}this.checkPowerUpCollision(e)&&(this.applyPowerUp(e.type),this.powerUps.splice(t,1),this.gameContainer.removeChild(e.container))}}checkPowerUpCollision(t){const e=t.getBounds(),i=this.paddle.getBounds();return e.left<i.right&&e.right>i.left&&e.top<i.bottom&&e.bottom>i.top}applyPowerUp(t){switch(t){case g.PADDLE_INCREASE:this.currentPaddleWidth=Math.min(this.currentPaddleWidth*1.3,f*2),this.paddle.resize(this.currentPaddleWidth);break;case g.PADDLE_DECREASE:this.currentPaddleWidth=Math.max(this.currentPaddleWidth*.8,f*.5),this.paddle.resize(this.currentPaddleWidth);break;case g.EXTRA_LIFE:this.safetyNetActive||(this.safetyNetActive=!0,this.safetyNet.visible=!0);break}}}let p=null,w=null;function q(){if(!w)return;const h=L(),t=w.view;t.style.width=`${n*h.scale}px`,t.style.height=`${a*h.scale}px`,console.log("Canvas resized:",{scale:h.scale,scaledWidth:n*h.scale,scaledHeight:a*h.scale,styleWidth:t.style.width,styleHeight:t.style.height})}async function J(){const h=L();w=new U({width:n,height:a,backgroundColor:2899536,antialias:!0,resolution:window.devicePixelRatio||1});const t=document.getElementById("gameContainer");if(t){const e=w.view;e.style.width=`${n*h.scale}px`,e.style.height=`${a*h.scale}px`,e.style.maxWidth="100%",e.style.maxHeight="100%",e.style.objectFit="contain",t.appendChild(e),console.log("Breakout dimensions:",{baseWidth:n,baseHeight:a,scale:h.scale,scaledWidth:n*h.scale,scaledHeight:a*h.scale,canvasWidth:e.width,canvasHeight:e.height,styleWidth:e.style.width,styleHeight:e.style.height})}p=new j(w),await p.init(),w.ticker.add(Q),window.addEventListener("resize",q)}function Q(h){p&&p.update(h)}window.restartGame=()=>{p&&p.restart()};window.returnToMainMenu=()=>{window.location.href="/arcade/"};window.resumeGame=()=>{p&&p.resume()};window.togglePause=()=>{p&&p.togglePause()};window.addEventListener("load",J);
//# sourceMappingURL=breakout-CfVkr_Or.js.map
