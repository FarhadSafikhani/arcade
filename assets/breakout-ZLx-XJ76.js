var t=Object.defineProperty,i=(i,e,s)=>((i,e,s)=>e in i?t(i,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[e]=s)(i,"symbol"!=typeof e?e+"":e,s);import"./modulepreload-polyfill-YP0FEG5d.js";import{C as e,G as s,T as h,a,A as n}from"./HTMLText-BW6zNa31.js";import{i as r}from"./device-detection-DiiT1QW1.js";class o{constructor(t,s){i(this,"container"),i(this,"x",0),i(this,"y",0),i(this,"width"),i(this,"height"),i(this,"graphics"),this.width=t,this.height=s,this.container=new e,this.updateGraphics()}updateGraphics(){this.graphics&&this.container.removeChild(this.graphics),this.graphics=new s,this.graphics.beginFill(5164484),this.graphics.drawRoundedRect(0,0,this.width,this.height,5),this.graphics.endFill(),this.graphics.lineStyle(2,16777215,.8),this.graphics.drawRoundedRect(0,0,this.width,this.height,5),this.container.addChild(this.graphics)}setPosition(t,i){this.x=t,this.y=i,this.container.x=t,this.container.y=i}resize(t){this.width=t,this.updateGraphics()}getBounds(){return{left:this.x,right:this.x+this.width,top:this.y,bottom:this.y+this.height}}}class l{constructor(t){i(this,"container"),i(this,"x",0),i(this,"y",0),i(this,"radius"),i(this,"velocityX",0),i(this,"velocityY",0),i(this,"graphics"),this.radius=t,this.container=new e,this.graphics=new s,this.graphics.beginFill(16777215),this.graphics.drawCircle(0,0,t),this.graphics.endFill(),this.graphics.lineStyle(2,2899536,.8),this.graphics.drawCircle(0,0,t),this.container.addChild(this.graphics)}setPosition(t,i){this.x=t,this.y=i,this.container.x=t,this.container.y=i}setVelocity(t,i){this.velocityX=t,this.velocityY=i}setVelocityAndAngle(t,i){this.velocityX=t*Math.sin(i),this.velocityY=-t*Math.cos(i)}setAngle(t){const i=Math.sqrt(this.velocityX*this.velocityX+this.velocityY*this.velocityY);this.velocityX=i*Math.sin(t),this.velocityY=-i*Math.cos(t)}reverseX(){this.velocityX=-this.velocityX}reverseY(){this.velocityY=-this.velocityY}update(){this.x+=this.velocityX,this.y+=this.velocityY,this.container.x=this.x,this.container.y=this.y}getBounds(){return{left:this.x-this.radius,right:this.x+this.radius,top:this.y-this.radius,bottom:this.y+this.radius}}checkCollisionWithPaddle(t){const i=this.getBounds(),e=t.getBounds();return i.left<e.right&&i.right>e.left&&i.top<e.bottom&&i.bottom>e.top}checkCollisionWithBrick(t){const i=this.getBounds(),e=t.getBounds();return i.left<e.right&&i.right>e.left&&i.top<e.bottom&&i.bottom>e.top}}class d{constructor(t,s,h){i(this,"container"),i(this,"x",0),i(this,"y",0),i(this,"width"),i(this,"height"),i(this,"maxHealth"),i(this,"health"),i(this,"graphics"),this.width=t,this.height=s,this.maxHealth=h,this.health=h,this.container=new e,this.updateGraphics()}updateGraphics(){this.graphics&&this.container.removeChild(this.graphics),this.graphics=new s;const t=[3066993,15844367,15105570,15158332,12597547][Math.max(0,this.health-1)];this.graphics.beginFill(t),this.graphics.drawRoundedRect(0,0,this.width,this.height,3),this.graphics.endFill(),this.graphics.lineStyle(1,16777215,.3),this.graphics.drawRoundedRect(0,0,this.width,this.height,3),this.graphics.lineStyle(1,16777215,.6),this.graphics.drawRoundedRect(2,2,this.width-4,this.height-4,2),this.container.addChild(this.graphics)}setPosition(t,i){this.x=t,this.y=i,this.container.x=t,this.container.y=i}hit(){return this.health--,this.updateGraphics(),this.health<=0}getBounds(){return{left:this.x,right:this.x+this.width,top:this.y,bottom:this.y+this.height}}getColor(){return[3066993,15844367,15105570,15158332,12597547][Math.max(0,this.health-1)]}}var c=(t=>(t.PADDLE_INCREASE="paddle_increase",t.PADDLE_DECREASE="paddle_decrease",t.EXTRA_LIFE="extra_life",t))(c||{});class p{constructor(t,s,h){i(this,"container"),i(this,"x",0),i(this,"y",0),i(this,"type"),i(this,"width",30),i(this,"height",30),i(this,"velocityY",2),i(this,"graphics"),i(this,"text"),this.type=t,this.x=s,this.y=h,this.container=new e,this.createGraphics(),this.setPosition(s,h)}createGraphics(){let t,i;switch(this.graphics=new s,this.type){case"paddle_increase":t=3066993,i="+";break;case"paddle_decrease":t=15158332,i="-";break;case"extra_life":t=15965202,i="â™¥"}this.graphics.beginFill(t),this.graphics.drawRoundedRect(0,0,this.width,this.height,5),this.graphics.endFill(),this.graphics.lineStyle(2,16777215,.8),this.graphics.drawRoundedRect(0,0,this.width,this.height,5);const e=new h({fontFamily:"Arial",fontSize:16,fontWeight:"bold",fill:16777215,stroke:0,strokeThickness:2});this.text=new a(i,e),this.text.anchor.set(.5),this.text.x=this.width/2,this.text.y=this.height/2,this.container.addChild(this.graphics),this.container.addChild(this.text)}setPosition(t,i){this.x=t,this.y=i,this.container.x=t,this.container.y=i}update(){this.y+=this.velocityY,this.container.y=this.y}getBounds(){return{left:this.x,right:this.x+this.width,top:this.y,bottom:this.y+this.height}}isOutOfBounds(t){return this.y>t}}class u{constructor(t,h,a){i(this,"container"),i(this,"graphics"),i(this,"velocityX"),i(this,"velocityY"),i(this,"life"),i(this,"maxLife"),i(this,"gravity",.3),i(this,"friction",.98),this.container=new e,this.container.position.set(t,h),this.graphics=new s,this.graphics.beginFill(a),this.graphics.drawCircle(0,0,3*Math.random()+1),this.graphics.endFill(),this.container.addChild(this.graphics),this.velocityX=8*(Math.random()-.5),this.velocityY=8*(Math.random()-.5)-2,this.maxLife=60*Math.random()+30,this.life=this.maxLife}update(){this.velocityY+=this.gravity,this.velocityX*=this.friction,this.velocityY*=this.friction,this.container.x+=this.velocityX,this.container.y+=this.velocityY,this.life--;const t=this.life/this.maxLife;this.graphics.alpha=t;const i=.5+.5*t;return this.graphics.scale.set(i),this.life>0}destroy(){this.container.parent&&this.container.parent.removeChild(this.container)}}class g{constructor(t){i(this,"particles",[]),i(this,"container"),this.container=t}createExplosion(t,i,e,s=8){for(let h=0;h<s;h++){const s=new u(t,i,e);this.particles.push(s),this.container.addChild(s.container)}}update(){for(let t=this.particles.length-1;t>=0;t--){const i=this.particles[t];i.update()||(i.destroy(),this.particles.splice(t,1))}}clear(){this.particles.forEach(t=>t.destroy()),this.particles=[]}}const m=900,y=500,v=100,w=r()?5.6:8,f=()=>{const t=window.innerWidth,i=window.innerHeight-120,e=t/m,s=i/y,h=Math.min(e,s);return{gameWidth:m,gameHeight:y,scale:h}};class b{constructor(t){i(this,"app"),i(this,"gameContainer"),i(this,"paddle"),i(this,"ball"),i(this,"bricks",[]),i(this,"powerUps",[]),i(this,"particleSystem"),i(this,"score",0),i(this,"lives",3),i(this,"level",1),i(this,"isGameOver",!1),i(this,"isPaused",!1),i(this,"isGameStarted",!1),i(this,"removeInputHandler"),i(this,"currentPaddleWidth",v),i(this,"safetyNetActive",!1),i(this,"safetyNet"),this.app=t,this.gameContainer=new e,this.app.stage.addChild(this.gameContainer),this.particleSystem=new g(this.gameContainer)}async init(){this.createBackground(),this.paddle=new o(v,20),this.gameContainer.addChild(this.paddle.container),this.ball=new l(10),this.gameContainer.addChild(this.ball.container),this.createBricks(),this.setupInput(),this.updateUI(),this.paddle.setPosition(450-this.currentPaddleWidth/2,470),this.resetBall()}createBackground(){const t=new s;t.beginFill(3426654),t.drawRect(0,0,m,y),t.endFill(),this.gameContainer.addChild(t),this.safetyNet=new s,this.safetyNet.beginFill(3066993,.7),this.safetyNet.drawRect(0,495,m,5),this.safetyNet.endFill(),this.safetyNet.visible=!1,this.gameContainer.addChild(this.safetyNet)}createBricks(){const t=[5,4,3,2,1];for(let i=0;i<5;i++)for(let e=0;e<10;e++){const s=89.9*e+1,h=50+31*i,a=new d(88.9,30,t[i]);a.setPosition(s,h),this.bricks.push(a),this.gameContainer.addChild(a.container)}}setupInput(){const t=t=>{if(!this.isGameOver)switch(t.key){case" ":case"Enter":t.preventDefault(),this.isGameStarted||this.startGame();break;case"Escape":t.preventDefault(),this.togglePause()}},i=t=>{if(this.isGameOver||this.isPaused)return;const i=t,e=this.app.view.getBoundingClientRect(),s=(i.clientX-e.left)/e.width*m-this.currentPaddleWidth/2,h=Math.max(0,Math.min(m-this.currentPaddleWidth,s));this.paddle.setPosition(h,470)},e=t=>{this.isGameOver||this.isPaused||this.isGameStarted||this.startGame()};let s=!1,h=!1,a=0,n=0;const r=t=>{if(this.isGameOver||this.isPaused)return;const i=t.touches[0];if(i.clientY<80)return;s=!0,h=!1,a=i.clientX,n=i.clientY,t.preventDefault();const e=i.clientX,r=this.app.view.getBoundingClientRect(),o=(e-r.left)/(r.width/m)-this.currentPaddleWidth/2,l=Math.max(0,Math.min(m-this.currentPaddleWidth,o));this.paddle.setPosition(l,470),this.isGameStarted||this.startGame()},o=t=>{if(!s||this.isGameOver||this.isPaused)return;const i=t.touches[0];if(i.clientY<80)return;t.preventDefault();const e=Math.abs(i.clientX-a),r=Math.abs(i.clientY-n),o=Math.sqrt(e*e+r*r);if(!h&&o>10&&(h=!0),h){const t=i.clientX,e=this.app.view.getBoundingClientRect(),s=(t-e.left)/(e.width/m)-this.currentPaddleWidth/2,h=Math.max(0,Math.min(m-this.currentPaddleWidth,s)),a=470;this.paddle.setPosition(h,a)}},l=t=>{s=!1,h=!1};document.addEventListener("keydown",t);const d=this.app.view;d.addEventListener("mousemove",i),d.addEventListener("click",e),document.addEventListener("touchstart",r,{passive:!1}),document.addEventListener("touchmove",o,{passive:!1}),document.addEventListener("touchend",l,{passive:!1}),this.removeInputHandler=()=>{document.removeEventListener("keydown",t),d.removeEventListener("mousemove",i),d.removeEventListener("click",e),document.removeEventListener("touchstart",r),document.removeEventListener("touchmove",o),document.removeEventListener("touchend",l)}}startGame(){this.isGameStarted=!0,this.ball.setVelocity(0,-w)}resetBall(){this.ball.setPosition(450,450),this.ball.setVelocity(0,0),this.isGameStarted=!1}update(t){this.isGameOver||this.isPaused||(this.isGameStarted?(this.ball.update(),this.checkCollisions()):this.ball.setPosition(this.paddle.x+this.currentPaddleWidth/2,450),this.updatePowerUps(),this.particleSystem.update())}checkCollisions(){const t=this.ball.getBounds();if(t.left<=0?(this.ball.setPosition(this.ball.radius,this.ball.y),this.ball.reverseX()):t.right>=m&&(this.ball.setPosition(m-this.ball.radius,this.ball.y),this.ball.reverseX()),t.top<=0&&(this.ball.setPosition(this.ball.x,this.ball.radius),this.ball.reverseY()),t.top>=y)this.safetyNetActive?(this.ball.setPosition(this.ball.x,y-this.ball.radius-5),this.ball.reverseY(),this.safetyNetActive=!1,this.safetyNet.visible=!1):this.loseLife();else{if(this.ball.checkCollisionWithPaddle(this.paddle)&&this.ball.y>this.paddle.y){this.ball.setPosition(this.ball.x,this.paddle.y-this.ball.radius),this.ball.reverseY();const t=(this.ball.x-this.paddle.x)/this.currentPaddleWidth,i=.5,e=Math.abs(t-i),s=w*(1+e),h=.8*(t-i);this.ball.setVelocityAndAngle(s,h)}for(let t=this.bricks.length-1;t>=0;t--){const i=this.bricks[t];if(this.ball.checkCollisionWithBrick(i)){const e=this.ball.getBounds(),s=i.getBounds();if(Math.min(e.right-s.left,s.right-e.left)<Math.min(e.bottom-s.top,s.bottom-e.top)?this.ball.reverseX():this.ball.reverseY(),i.hit()){const e=i.getColor();this.particleSystem.createExplosion(i.x+44.45,i.y+15,e,12),this.bricks.splice(t,1),this.gameContainer.removeChild(i.container),Math.random()<.1&&this.spawnPowerUp(i.x+44.45,i.y+30)}this.score+=10,this.updateUI(),0===this.bricks.length&&this.nextLevel();break}}}}loseLife(){this.lives--,this.updateUI(),this.currentPaddleWidth=v,this.paddle.resize(this.currentPaddleWidth),this.lives<=0?this.gameOver():this.resetBall()}nextLevel(){this.level++,this.updateUI(),this.createBricks(),this.resetBall()}gameOver(){this.isGameOver=!0,this.showGameOver()}showGameOver(){const t=document.getElementById("gameOver"),i=document.getElementById("finalScore");t&&i&&(i.textContent=this.score.toString(),t.style.display="block")}togglePause(){this.isPaused=!this.isPaused,this.isPaused?this.showPauseMenu():this.hidePauseMenu()}showPauseMenu(){const t=document.getElementById("pauseMenu");t&&(t.style.display="block")}hidePauseMenu(){const t=document.getElementById("pauseMenu");t&&(t.style.display="none")}updateUI(){const t=document.getElementById("score"),i=document.getElementById("lives"),e=document.getElementById("level");t&&(t.textContent=this.score.toString()),i&&(i.textContent=this.lives.toString()),e&&(e.textContent=this.level.toString())}restart(){this.score=0,this.lives=3,this.level=1,this.isGameOver=!1,this.isPaused=!1,this.isGameStarted=!1,this.currentPaddleWidth=v,this.safetyNetActive=!1,this.safetyNet.visible=!1,this.particleSystem.clear(),this.bricks.forEach(t=>{this.gameContainer.removeChild(t.container)}),this.bricks=[],this.powerUps.forEach(t=>{this.gameContainer.removeChild(t.container)}),this.powerUps=[],this.createBricks(),this.resetBall(),this.paddle.setPosition(450-this.currentPaddleWidth/2,470),this.paddle.resize(this.currentPaddleWidth),this.updateUI();const t=document.getElementById("gameOver");t&&(t.style.display="none"),this.hidePauseMenu()}resume(){this.isPaused=!1,this.hidePauseMenu()}destroy(){this.removeInputHandler&&this.removeInputHandler(),this.particleSystem.clear(),this.gameContainer&&this.gameContainer.parent&&this.gameContainer.parent.removeChild(this.gameContainer)}spawnPowerUp(t,i){const e=[c.PADDLE_INCREASE,c.PADDLE_DECREASE,c.EXTRA_LIFE],s=e[Math.floor(Math.random()*e.length)],h=new p(s,t,i);this.powerUps.push(h),this.gameContainer.addChild(h.container)}updatePowerUps(){for(let t=this.powerUps.length-1;t>=0;t--){const i=this.powerUps[t];i.update(),i.isOutOfBounds(y)?(this.powerUps.splice(t,1),this.gameContainer.removeChild(i.container)):this.checkPowerUpCollision(i)&&(this.applyPowerUp(i.type),this.powerUps.splice(t,1),this.gameContainer.removeChild(i.container))}}checkPowerUpCollision(t){const i=t.getBounds(),e=this.paddle.getBounds();return i.left<e.right&&i.right>e.left&&i.top<e.bottom&&i.bottom>e.top}applyPowerUp(t){switch(t){case c.PADDLE_INCREASE:this.currentPaddleWidth=Math.min(1.3*this.currentPaddleWidth,200),this.paddle.resize(this.currentPaddleWidth);break;case c.PADDLE_DECREASE:this.currentPaddleWidth=Math.max(.8*this.currentPaddleWidth,50),this.paddle.resize(this.currentPaddleWidth);break;case c.EXTRA_LIFE:this.safetyNetActive||(this.safetyNetActive=!0,this.safetyNet.visible=!0)}}movePaddle(t){if(this.isGameOver||this.isPaused)return;const i=Math.max(0,Math.min(m-this.currentPaddleWidth,this.paddle.x+t));this.paddle.setPosition(i,470)}}let P=null,x=null;function C(){if(!x)return;const t=f(),i=x.view;i.style.width=m*t.scale+"px",i.style.height=y*t.scale+"px"}function E(t){P&&P.update(t)}window.restartGame=()=>{P&&P.restart()},window.returnToMainMenu=()=>{window.location.href="/arcade/"},window.resumeGame=()=>{P&&P.resume()},window.togglePause=()=>{P&&P.togglePause()},window.addEventListener("load",async function(){const t=f();x=new n({width:m,height:y,backgroundColor:2899536,antialias:!0,resolution:window.devicePixelRatio||1});const i=document.getElementById("gameContainer");if(i){const e=x.view;e.style.width=m*t.scale+"px",e.style.height=y*t.scale+"px",e.style.maxWidth="100%",e.style.maxHeight="100%",e.style.objectFit="contain",i.appendChild(e)}P=new b(x),await P.init(),x.ticker.add(E),window.addEventListener("resize",C)});
